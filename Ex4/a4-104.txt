SQL> set echo on:
SP2-0158: unknown SET option ":"
SQL> 
SQL> @z:/air_main.sql
SP2-0310: unable to open file "z:/air_main.sql"
SQL> 
SQL> REM: *************************************************************** Ex4-VIEWS ***************************************************************
SQL> 
SQL> REM: To create a view based on table(s) or view(s) and observe its behavior while performing update
SQL> REM: operations on it.
SQL> REM: Use the schema from Assignment - 3 for the following:
SQL> 
SQL> SELECT * FROM fl_schedule WHERE flno='HA-1';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
HA-1    15-APR-05       1110 15-APR-05       1445     375.23                                                                                                                                                                                                                                                

SQL> SELECT * FROM flights WHERE flightno='HA-1';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
HA-1    LH106          13                                                                                                                                                                                                                                                                                   

SQL> 
SQL> REM: 1. Create a view Schedule_15 that display the flight number, route, airport(origin, destination)
SQL> REM:    departure (date, time), arrival (date, time) of a flight on 15 apr 2005. Label the view
SQL> REM:    column as flight, route, from_airport, to_airport, ddate, dtime, adate, atime respectively.
SQL> 
SQL> CREATE OR REPLACE VIEW Schedule_15 (flight, route, from_airport, to_airport, ddate, dtime, adate, atime) AS
  2  SELECT fl.flno,
  3  r.routeid,
  4  r.orig_airport,
  5  r.dest_airport,
  6  fl.departs,
  7  fl.dtime,
  8  fl.arrives,
  9  fl.atime
 10  FROM flights f, fl_schedule fl, routes r
 11  WHERE fl.flno=f.flightno AND f.rid=r.routeid
 12  AND fl.departs=TO_DATE('15-04-2005', 'dd-mm-yyyy');

View created.

SQL> 
SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                          
HA-1    LH106  Los Angeles          Honolulu             15-APR-05       1110 15-APR-05       1445                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

8 rows selected.

SQL> 
SQL> REM: INSERT OPERATION ON VIEW Schedule_15
SQL> INSERT INTO Schedule_15 VALUES('NIV-104', 'CH20', 'Tokyo', '27-SEP-2022', 'Seoul', 2100, '27-SEP-2022', 2144);
INSERT INTO Schedule_15 VALUES('NIV-104', 'CH20', 'Tokyo', '27-SEP-2022', 'Seoul', 2100, '27-SEP-2022', 2144)
*
ERROR at line 1:
ORA-01776: cannot modify more than one base table through a join view 


SQL> 
SQL> REM: UPDATE OPERATION ON VIEW Schedule_15
SQL> UPDATE Schedule_15 SET from_airport='Tokyo' WHERE flight='HA-1';
UPDATE Schedule_15 SET from_airport='Tokyo' WHERE flight='HA-1'
                       *
ERROR at line 1:
ORA-01779: cannot modify a column which maps to a non key-preserved table 


SQL> 
SQL> REM: DELETE OPERATION ON VIEW Schedule_15
SQL> DELETE FROM Schedule_15 WHERE flight='HA-1';

1 row deleted.

SQL> 
SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

7 rows selected.

SQL> 
SQL> SELECT * FROM fl_schedule WHERE flno='HA-1';

no rows selected

SQL> SELECT * FROM flights WHERE flightno='HA-1';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
HA-1    LH106          13                                                                                                                                                                                                                                                                                   

SQL> 
SQL> REM: 2. Define a view Airtype that display the number of aircrafts for each of its type. Label the
SQL> REM:    column as craft_type, total.
SQL> 
SQL> CREATE OR REPLACE VIEW Airtype AS
  2  SELECT type craft_type, COUNT(*) AS total
  3  FROM aircraft
  4  GROUP BY type;

View created.

SQL> 
SQL> SELECT * FROM Airtype;

CRAFT_TYPE      TOTAL                                                                                                                                                                                                                                                                                       
---------- ----------                                                                                                                                                                                                                                                                                       
Boeing              6                                                                                                                                                                                                                                                                                       
Saab                1                                                                                                                                                                                                                                                                                       
Airbus              3                                                                                                                                                                                                                                                                                       
BAe                 1                                                                                                                                                                                                                                                                                       
Schweizer           1                                                                                                                                                                                                                                                                                       
Piper               1                                                                                                                                                                                                                                                                                       
Lockheed            1                                                                                                                                                                                                                                                                                       
Tupolev             1                                                                                                                                                                                                                                                                                       
Embraer             1                                                                                                                                                                                                                                                                                       

9 rows selected.

SQL> 
SQL> REM: INSERT OPERATION ON VIEW Airtype
SQL> INSERT INTO Airtype VALUES('NiveStar', 100);
INSERT INTO Airtype VALUES('NiveStar', 100)
*
ERROR at line 1:
ORA-01733: virtual column not allowed here 


SQL> 
SQL> REM: UPDATE OPERATION ON VIEW Airtype
SQL> UPDATE Airtype SET craft_type='NiveStar' WHERE total=1;
UPDATE Airtype SET craft_type='NiveStar' WHERE total=1
       *
ERROR at line 1:
ORA-01732: data manipulation operation not legal on this view 


SQL> 
SQL> REM: DELETE OPERATION ON VIEW Airtype
SQL> DELETE FROM Airtype WHERE total=1;
DELETE FROM Airtype WHERE total=1
            *
ERROR at line 1:
ORA-01732: data manipulation operation not legal on this view 


SQL> DELETE FROM Airtype WHERE craft_type='Boeing';
DELETE FROM Airtype WHERE craft_type='Boeing'
            *
ERROR at line 1:
ORA-01732: data manipulation operation not legal on this view 


SQL> 
SQL> REM: 3. Create a view Losangeles_Route that contains Los Angeles in the route. Ensure that the view
SQL> REM:    always contain/allows only information about the Los Angeles route.
SQL> 
SQL> CREATE OR REPLACE VIEW Losangeles_Route AS
  2  SELECT * FROM routes
  3  WHERE orig_airport='Los Angeles' OR dest_airport='Los Angeles' WITH CHECK OPTION;

View created.

SQL> 
SQL> SELECT * FROM Losangeles_Route;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

9 rows selected.

SQL> 
SQL> REM: INSERT OPERATION ON VIEW Losangeles_Route
SQL> INSERT INTO Losangeles_Route VALUES('NIV-27', 'Tokyo', 'Seoul', 27900);
INSERT INTO Losangeles_Route VALUES('NIV-27', 'Tokyo', 'Seoul', 27900)
            *
ERROR at line 1:
ORA-01402: view WITH CHECK OPTION where-clause violation 


SQL> INSERT INTO Losangeles_Route VALUES('NIV-27', 'Los Angeles', 'Seoul', 27900);

1 row created.

SQL> 
SQL> SELECT * FROM Losangeles_Route;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 
NIV-27 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

10 rows selected.

SQL> SELECT * FROM routes;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
CN151  Chicago              New York                    802                                                                                                                                                                                                                                                 
MD200  Madison              Detroit                     319                                                                                                                                                                                                                                                 
DN250  Detroit              New York                    470                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
DM251  Detroit              Montreal                    517                                                                                                                                                                                                                                                 
MN204  Madison              New York                    789                                                                                                                                                                                                                                                 
MC201  Madison              Chicago                     150                                                                                                                                                                                                                                                 
MP202  Madison              Pittsburgh                  510                                                                                                                                                                                                                                                 
MM203  Madison              Minneapolis                 247                                                                                                                                                                                                                                                 
MNY300 Minneapolis          New York                    991                                                                                                                                                                                                                                                 
PN350  Pittsburgh           New York                    303                                                                                                                                                                                                                                                 
PC351  Pittsburgh           Chicago                     409                                                                                                                                                                                                                                                 
NYL400 New York             London                     3471                                                                                                                                                                                                                                                 
NYP401 New York             Paris                      3631                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
NIV-27 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

23 rows selected.

SQL> 
SQL> REM: UPDATE OPERATION ON VIEW Losangeles_Route
SQL> SELECT * FROM Losangeles_Route;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 
NIV-27 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

10 rows selected.

SQL> SELECT * FROM routes;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
CN151  Chicago              New York                    802                                                                                                                                                                                                                                                 
MD200  Madison              Detroit                     319                                                                                                                                                                                                                                                 
DN250  Detroit              New York                    470                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
DM251  Detroit              Montreal                    517                                                                                                                                                                                                                                                 
MN204  Madison              New York                    789                                                                                                                                                                                                                                                 
MC201  Madison              Chicago                     150                                                                                                                                                                                                                                                 
MP202  Madison              Pittsburgh                  510                                                                                                                                                                                                                                                 
MM203  Madison              Minneapolis                 247                                                                                                                                                                                                                                                 
MNY300 Minneapolis          New York                    991                                                                                                                                                                                                                                                 
PN350  Pittsburgh           New York                    303                                                                                                                                                                                                                                                 
PC351  Pittsburgh           Chicago                     409                                                                                                                                                                                                                                                 
NYL400 New York             London                     3471                                                                                                                                                                                                                                                 
NYP401 New York             Paris                      3631                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
NIV-27 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

23 rows selected.

SQL> 
SQL> UPDATE Losangeles_Route SET routeid='NIV-99' WHERE routeid='NIV-27';

1 row updated.

SQL> 
SQL> SELECT * FROM Losangeles_Route;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 
NIV-99 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

10 rows selected.

SQL> SELECT * FROM routes;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
CN151  Chicago              New York                    802                                                                                                                                                                                                                                                 
MD200  Madison              Detroit                     319                                                                                                                                                                                                                                                 
DN250  Detroit              New York                    470                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
DM251  Detroit              Montreal                    517                                                                                                                                                                                                                                                 
MN204  Madison              New York                    789                                                                                                                                                                                                                                                 
MC201  Madison              Chicago                     150                                                                                                                                                                                                                                                 
MP202  Madison              Pittsburgh                  510                                                                                                                                                                                                                                                 
MM203  Madison              Minneapolis                 247                                                                                                                                                                                                                                                 
MNY300 Minneapolis          New York                    991                                                                                                                                                                                                                                                 
PN350  Pittsburgh           New York                    303                                                                                                                                                                                                                                                 
PC351  Pittsburgh           Chicago                     409                                                                                                                                                                                                                                                 
NYL400 New York             London                     3471                                                                                                                                                                                                                                                 
NYP401 New York             Paris                      3631                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
NIV-99 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

23 rows selected.

SQL> 
SQL> REM: DELETE OPERATION ON VIEW Losangeles_Route
SQL> SELECT * FROM Losangeles_Route;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 
NIV-99 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

10 rows selected.

SQL> SELECT * FROM routes;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
CN151  Chicago              New York                    802                                                                                                                                                                                                                                                 
MD200  Madison              Detroit                     319                                                                                                                                                                                                                                                 
DN250  Detroit              New York                    470                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
DM251  Detroit              Montreal                    517                                                                                                                                                                                                                                                 
MN204  Madison              New York                    789                                                                                                                                                                                                                                                 
MC201  Madison              Chicago                     150                                                                                                                                                                                                                                                 
MP202  Madison              Pittsburgh                  510                                                                                                                                                                                                                                                 
MM203  Madison              Minneapolis                 247                                                                                                                                                                                                                                                 
MNY300 Minneapolis          New York                    991                                                                                                                                                                                                                                                 
PN350  Pittsburgh           New York                    303                                                                                                                                                                                                                                                 
PC351  Pittsburgh           Chicago                     409                                                                                                                                                                                                                                                 
NYL400 New York             London                     3471                                                                                                                                                                                                                                                 
NYP401 New York             Paris                      3631                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
NIV-99 Los Angeles          Seoul                     27900                                                                                                                                                                                                                                                 

23 rows selected.

SQL> 
SQL> DELETE FROM Losangeles_Route WHERE routeid='NIV-99';

1 row deleted.

SQL> 
SQL> SELECT * FROM Losangeles_Route;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

9 rows selected.

SQL> SELECT * FROM routes;

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
LW100  Los Angeles          Washington D.C.            2308                                                                                                                                                                                                                                                 
LC101  Los Angeles          Chicago                    1749                                                                                                                                                                                                                                                 
LD102  Los Angeles          Dallas                     1251                                                                                                                                                                                                                                                 
LB103  Los Angeles          Boston                     2606                                                                                                                                                                                                                                                 
LS104  Los Angeles          Sydney                     7487                                                                                                                                                                                                                                                 
LT105  Los Angeles          Tokyo                      5478                                                                                                                                                                                                                                                 
LH106  Los Angeles          Honolulu                   2551                                                                                                                                                                                                                                                 
CL150  Chicago              Los Angeles                1749                                                                                                                                                                                                                                                 
CN151  Chicago              New York                    802                                                                                                                                                                                                                                                 
MD200  Madison              Detroit                     319                                                                                                                                                                                                                                                 
DN250  Detroit              New York                    470                                                                                                                                                                                                                                                 

ROUTEI ORIG_AIRPORT         DEST_AIRPORT           DISTANCE                                                                                                                                                                                                                                                 
------ -------------------- -------------------- ----------                                                                                                                                                                                                                                                 
DM251  Detroit              Montreal                    517                                                                                                                                                                                                                                                 
MN204  Madison              New York                    789                                                                                                                                                                                                                                                 
MC201  Madison              Chicago                     150                                                                                                                                                                                                                                                 
MP202  Madison              Pittsburgh                  510                                                                                                                                                                                                                                                 
MM203  Madison              Minneapolis                 247                                                                                                                                                                                                                                                 
MNY300 Minneapolis          New York                    991                                                                                                                                                                                                                                                 
PN350  Pittsburgh           New York                    303                                                                                                                                                                                                                                                 
PC351  Pittsburgh           Chicago                     409                                                                                                                                                                                                                                                 
NYL400 New York             London                     3471                                                                                                                                                                                                                                                 
NYP401 New York             Paris                      3631                                                                                                                                                                                                                                                 
LNY107 Los Angeles          New York                   2510                                                                                                                                                                                                                                                 

22 rows selected.

SQL> 
SQL> REM: 4. Create a view named Losangeles_Flight on Schedule_15 (as defined in 1) that display flight,
SQL> REM:    departure (date, time), arrival (date, time) of flight(s) from Los Angeles.
SQL> 
SQL> CREATE OR REPLACE VIEW Losangeles_Flight AS
  2  SELECT flight, ddate, dtime, adate, atime AS arrival
  3  FROM Schedule_15
  4  WHERE from_airport='Los Angeles';

View created.

SQL> 
SQL> SELECT * FROM Losangeles_Flight;

FLIGHT  DDATE          DTIME ADATE        ARRIVAL                                                                                                                                                                                                                                                           
------- --------- ---------- --------- ----------                                                                                                                                                                                                                                                           
JJ-2482 15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                                                                           
SQ-11   15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                                                                           

SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

7 rows selected.

SQL> SELECT * FROM fl_schedule WHERE flno='SQ-11';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
SQ-11   15-APR-05       1230 16-APR-05       2055     780.99                                                                                                                                                                                                                                                

SQL> SELECT * FROM flights WHERE flightno='SQ-11';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
SQ-11   LT105          11                                                                                                                                                                                                                                                                                   

SQL> 
SQL> REM: INSERT OPERATION ON VIEW Losangeles_Flight
SQL> INSERT INTO Losangeles_Flight VALUES('SQ-11', '27-SEP-2020', 1850, '28-SEP-2020', 2100);

1 row created.

SQL> 
SQL> SELECT * FROM Losangeles_Flight;

FLIGHT  DDATE          DTIME ADATE        ARRIVAL                                                                                                                                                                                                                                                           
------- --------- ---------- --------- ----------                                                                                                                                                                                                                                                           
JJ-2482 15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                                                                           
SQ-11   15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                                                                           

SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

7 rows selected.

SQL> SELECT * FROM fl_schedule WHERE flno='SQ-11';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
SQ-11   15-APR-05       1230 16-APR-05       2055     780.99                                                                                                                                                                                                                                                
SQ-11   27-SEP-20       1850 28-SEP-20       2100                                                                                                                                                                                                                                                           

SQL> SELECT * FROM flights WHERE flightno='SQ-11';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
SQ-11   LT105          11                                                                                                                                                                                                                                                                                   

SQL> 
SQL> REM: UPDATE OPERATION ON VIEW Losangeles_Flight
SQL> SELECT * FROM Losangeles_Flight;

FLIGHT  DDATE          DTIME ADATE        ARRIVAL                                                                                                                                                                                                                                                           
------- --------- ---------- --------- ----------                                                                                                                                                                                                                                                           
JJ-2482 15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                                                                           
SQ-11   15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                                                                           

SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1230 16-APR-05       2055                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

7 rows selected.

SQL> SELECT * FROM fl_schedule WHERE flno='SQ-11';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
SQ-11   15-APR-05       1230 16-APR-05       2055     780.99                                                                                                                                                                                                                                                
SQ-11   27-SEP-20       1850 28-SEP-20       2100                                                                                                                                                                                                                                                           

SQL> SELECT * FROM flights WHERE flightno='SQ-11';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
SQ-11   LT105          11                                                                                                                                                                                                                                                                                   

SQL> 
SQL> UPDATE Losangeles_Flight SET dtime=1300 WHERE flight='SQ-11';

1 row updated.

SQL> 
SQL> SELECT * FROM Losangeles_Flight;

FLIGHT  DDATE          DTIME ADATE        ARRIVAL                                                                                                                                                                                                                                                           
------- --------- ---------- --------- ----------                                                                                                                                                                                                                                                           
JJ-2482 15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                                                                           
SQ-11   15-APR-05       1300 16-APR-05       2055                                                                                                                                                                                                                                                           

SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1300 16-APR-05       2055                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

7 rows selected.

SQL> SELECT * FROM fl_schedule WHERE flno='SQ-11';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
SQ-11   15-APR-05       1300 16-APR-05       2055     780.99                                                                                                                                                                                                                                                
SQ-11   27-SEP-20       1850 28-SEP-20       2100                                                                                                                                                                                                                                                           

SQL> SELECT * FROM flights WHERE flightno='SQ-11';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
SQ-11   LT105          11                                                                                                                                                                                                                                                                                   

SQL> 
SQL> REM: DELETE OPERATION ON VIEW Losangeles_Flight
SQL> SELECT * FROM Losangeles_Flight;

FLIGHT  DDATE          DTIME ADATE        ARRIVAL                                                                                                                                                                                                                                                           
------- --------- ---------- --------- ----------                                                                                                                                                                                                                                                           
JJ-2482 15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                                                                           
SQ-11   15-APR-05       1300 16-APR-05       2055                                                                                                                                                                                                                                                           

SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
SQ-11   LT105  Los Angeles          Tokyo                15-APR-05       1300 16-APR-05       2055                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

7 rows selected.

SQL> SELECT * FROM fl_schedule WHERE flno='SQ-11';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
SQ-11   15-APR-05       1300 16-APR-05       2055     780.99                                                                                                                                                                                                                                                
SQ-11   27-SEP-20       1850 28-SEP-20       2100                                                                                                                                                                                                                                                           

SQL> SELECT * FROM flights WHERE flightno='SQ-11';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
SQ-11   LT105          11                                                                                                                                                                                                                                                                                   

SQL> 
SQL> DELETE FROM Losangeles_Flight WHERE flight='SQ-11';

1 row deleted.

SQL> 
SQL> SELECT * FROM Losangeles_Flight;

FLIGHT  DDATE          DTIME ADATE        ARRIVAL                                                                                                                                                                                                                                                           
------- --------- ---------- --------- ----------                                                                                                                                                                                                                                                           
JJ-2482 15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                                                                           

SQL> SELECT * FROM Schedule_15;

FLIGHT  ROUTE  FROM_AIRPORT         TO_AIRPORT           DDATE          DTIME ADATE          ATIME                                                                                                                                                                                                          
------- ------ -------------------- -------------------- --------- ---------- --------- ----------                                                                                                                                                                                                          
JJ-2482 LW100  Los Angeles          Washington D.C.      15-APR-05       1230 15-APR-05       1540                                                                                                                                                                                                          
A5-3246 CN151  Chicago              New York             15-APR-05       1810 15-APR-05       1900                                                                                                                                                                                                          
9E-3851 MD200  Madison              Detroit              15-APR-05       1035 15-APR-05       1140                                                                                                                                                                                                          
MQ-4477 DN250  Detroit              New York             15-APR-05       1510 15-APR-05       1600                                                                                                                                                                                                          
RP-5018 MC201  Madison              Chicago              15-APR-05       2100 15-APR-05       2155                                                                                                                                                                                                          
BA-178  NYL400 New York             London               15-APR-05       1140 16-APR-05       1020                                                                                                                                                                                                          

6 rows selected.

SQL> SELECT * FROM fl_schedule WHERE flno='SQ-11';

FLNO    DEPARTS        DTIME ARRIVES        ATIME      PRICE                                                                                                                                                                                                                                                
------- --------- ---------- --------- ---------- ----------                                                                                                                                                                                                                                                
SQ-11   27-SEP-20       1850 28-SEP-20       2100                                                                                                                                                                                                                                                           

SQL> SELECT * FROM flights WHERE flightno='SQ-11';

FLIGHTN RID           AID                                                                                                                                                                                                                                                                                   
------- ------ ----------                                                                                                                                                                                                                                                                                   
SQ-11   LT105          11                                                                                                                                                                                                                                                                                   

SQL> spool off
